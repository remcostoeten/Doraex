<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floating Help Widget</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            position: relative;
        }

        /* Floating help widget container */
        .help-widget {
            position: fixed;
            bottom: 64px;
            right: 64px;
            z-index: 1000;
        }

        /* Collapsed state - blue circle */
        .help-button {
            width: 48px;
            height: 48px;
            background-color: #007bff;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3),
                        0 2px 8px rgba(0, 123, 255, 0.2);
            transition: all 0.2s ease;
            position: relative;
        }

        .help-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 123, 255, 0.4),
                        0 4px 12px rgba(0, 123, 255, 0.3);
        }

        .help-button:focus {
            outline: 2px solid #007bff;
            outline-offset: 2px;
        }

        /* Question mark SVG */
        .help-button svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        /* Expanded card */
        .help-card {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 320px;
            height: 420px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15),
                        0 8px 24px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: scale(0);
            transform-origin: bottom right;
            transition: all 0.3s cubic-bezier(0.19, 1, 0.22, 1);
            pointer-events: none;
            overflow: hidden;
        }

        .help-card.visible {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }

        /* Card header */
        .help-card-header {
            padding: 20px 20px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e9ecef;
            padding-bottom: 16px;
            margin-bottom: 16px;
        }

        .help-card-title {
            font-size: 18px;
            font-weight: 600;
            color: #212529;
        }

        .close-button {
            width: 24px;
            height: 24px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            transition: all 0.2s ease;
        }

        .close-button:hover {
            background-color: #f8f9fa;
            color: #495057;
        }

        .close-button:focus {
            outline: 2px solid #007bff;
            outline-offset: 1px;
            background-color: #f8f9fa;
        }

        /* Main content container */
        .help-card-content {
            position: relative;
            height: calc(100% - 72px);
            overflow: hidden;
        }

        /* Main panel - scrollable list */
        .help-main-panel {
            height: 100%;
            overflow-y: auto;
            padding: 0 20px 20px;
            transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1);
        }

        .help-main-panel.shifted {
            transform: translateX(-100%);
        }

        .help-list {
            list-style: none;
        }

        .help-list-item {
            padding: 12px 0;
            border-bottom: 1px solid #f1f3f4;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s ease;
        }

        .help-list-item:hover {
            background-color: #f8f9fa;
            margin: 0 -12px;
            padding-left: 12px;
            padding-right: 12px;
            border-radius: 8px;
        }

        .help-list-item:last-child {
            border-bottom: none;
        }

        .help-list-label {
            font-size: 14px;
            font-weight: 500;
            color: #495057;
        }

        .chevron-icon {
            width: 16px;
            height: 16px;
            color: #6c757d;
            transition: transform 0.2s ease;
        }

        .help-list-item:hover .chevron-icon {
            transform: translateX(2px);
        }

        /* Side panel */
        .help-side-panel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            transform: translateX(100%);
            transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1);
            padding: 20px;
            overflow-y: auto;
        }

        .help-side-panel.visible {
            transform: translateX(0);
        }

        .side-panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid #e9ecef;
        }

        .back-button {
            width: 24px;
            height: 24px;
            border: none;
            background: none;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6c757d;
            margin-right: 12px;
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background-color: #f8f9fa;
            color: #495057;
        }

        .back-button:focus {
            outline: 2px solid #007bff;
            outline-offset: 1px;
            background-color: #f8f9fa;
        }

        .help-list-item:focus-within {
            outline: 2px solid #007bff;
            outline-offset: 1px;
            background-color: #f8f9fa;
            margin: 0 -12px;
            padding-left: 12px;
            padding-right: 12px;
            border-radius: 8px;
        }

        .side-panel-title {
            font-size: 16px;
            font-weight: 600;
            color: #212529;
        }

        .side-panel-content {
            font-size: 14px;
            line-height: 1.5;
            color: #495057;
        }

        /* Custom scrollbar for webkit browsers */
        .help-main-panel::-webkit-scrollbar,
        .help-side-panel::-webkit-scrollbar {
            width: 4px;
        }

        .help-main-panel::-webkit-scrollbar-track,
        .help-side-panel::-webkit-scrollbar-track {
            background: transparent;
        }

        .help-main-panel::-webkit-scrollbar-thumb,
        .help-side-panel::-webkit-scrollbar-thumb {
            background-color: #dee2e6;
            border-radius: 2px;
        }

        .help-main-panel::-webkit-scrollbar-thumb:hover,
        .help-side-panel::-webkit-scrollbar-thumb:hover {
            background-color: #adb5bd;
        }
    </style>
</head>
<body>
    <div class="help-widget">
        <button class="help-button" id="helpButton" onclick="toggleHelpWidget()" aria-expanded="false" aria-haspopup="dialog" aria-label="Open help dialog">
            <svg viewBox="0 0 24 24">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/>
            </svg>
        </button>
        
        <div class="help-card" id="helpCard" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
            <div class="help-card-header">
                <h3 id="helpTitle" class="help-card-title">Documentation</h3>
                <button class="close-button" onclick="closeHelpWidget()" aria-label="Close help dialog">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            
            <div class="help-card-content">
                <div class="help-main-panel" id="mainPanel">
                    <ul class="help-list">
                        <li class="help-list-item" onclick="showSidePanel('connections')">
                            <span class="help-list-label">Connections</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('query-editor')">
                            <span class="help-list-label">Query editor</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('data-sources')">
                            <span class="help-list-label">Data sources</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('visualizations')">
                            <span class="help-list-label">Visualizations</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('dashboards')">
                            <span class="help-list-label">Dashboards</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('user-management')">
                            <span class="help-list-label">User management</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('settings')">
                            <span class="help-list-label">Settings</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                        <li class="help-list-item" onclick="showSidePanel('api-reference')">
                            <span class="help-list-label">API Reference</span>
                            <svg class="chevron-icon" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                            </svg>
                        </li>
                    </ul>
                </div>
                
                <div class="help-side-panel" id="sidePanel">
                    <div class="side-panel-header">
                        <button class="back-button" onclick="hideSidePanel()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M14 7l-5 5 5 5V7z"/>
                            </svg>
                        </button>
                        <h4 class="side-panel-title" id="sidePanelTitle">Section</h4>
                    </div>
                    <div class="side-panel-content" id="sidePanelContent">
                        <!-- Content will be populated by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Content for different sections
        const helpContent = {
            'connections': {
                title: 'Connections',
                content: `
                    <h5>Managing Database Connections</h5>
                    <p>Learn how to set up and manage your database connections securely.</p>
                    <ul>
                        <li>Add new database connections</li>
                        <li>Test connection health</li>
                        <li>Manage connection pools</li>
                        <li>Configure SSL/TLS settings</li>
                    </ul>
                    <p>Click the "+" button in the connections panel to add a new connection. You'll need to provide connection details like host, port, username, and password.</p>
                `
            },
            'query-editor': {
                title: 'Query Editor',
                content: `
                    <h5>Writing and Executing Queries</h5>
                    <p>The query editor provides a powerful interface for writing and running SQL queries.</p>
                    <ul>
                        <li>Syntax highlighting for SQL</li>
                        <li>Auto-completion and suggestions</li>
                        <li>Query history and favorites</li>
                        <li>Export results to various formats</li>
                    </ul>
                    <p>Use <strong>Ctrl+Enter</strong> to execute your query. Results will appear in the panel below.</p>
                `
            },
            'data-sources': {
                title: 'Data Sources',
                content: `
                    <h5>Configuring Data Sources</h5>
                    <p>Connect to various types of databases and data sources.</p>
                    <ul>
                        <li>PostgreSQL, MySQL, SQLite</li>
                        <li>MongoDB, Redis</li>
                        <li>API endpoints and webhooks</li>
                        <li>File uploads (CSV, JSON)</li>
                    </ul>
                    <p>Each data source type has specific configuration requirements. Refer to the connection wizard for detailed setup instructions.</p>
                `
            },
            'visualizations': {
                title: 'Visualizations',
                content: `
                    <h5>Creating Charts and Graphs</h5>
                    <p>Transform your query results into meaningful visualizations.</p>
                    <ul>
                        <li>Bar charts, line graphs, pie charts</li>
                        <li>Scatter plots and heat maps</li>
                        <li>Custom styling and themes</li>
                        <li>Interactive filtering options</li>
                    </ul>
                    <p>Select data columns and choose a visualization type to get started. You can customize colors, labels, and other styling options.</p>
                `
            },
            'dashboards': {
                title: 'Dashboards',
                content: `
                    <h5>Building Interactive Dashboards</h5>
                    <p>Combine multiple visualizations into comprehensive dashboards.</p>
                    <ul>
                        <li>Drag-and-drop dashboard builder</li>
                        <li>Real-time data updates</li>
                        <li>Responsive layouts</li>
                        <li>Share and collaborate</li>
                    </ul>
                    <p>Create a new dashboard and add widgets by dragging visualizations from your library. Resize and arrange them as needed.</p>
                `
            },
            'user-management': {
                title: 'User Management',
                content: `
                    <h5>Managing Users and Permissions</h5>
                    <p>Control access to your data and dashboards with user management features.</p>
                    <ul>
                        <li>Create and manage user accounts</li>
                        <li>Role-based access control</li>
                        <li>Team collaboration features</li>
                        <li>Audit logs and activity tracking</li>
                    </ul>
                    <p>Admin users can invite new team members and assign appropriate roles and permissions.</p>
                `
            },
            'settings': {
                title: 'Settings',
                content: `
                    <h5>Application Settings</h5>
                    <p>Configure global settings and preferences for your application.</p>
                    <ul>
                        <li>Theme and appearance settings</li>
                        <li>Default query timeout values</li>
                        <li>Security and privacy options</li>
                        <li>Email notifications</li>
                    </ul>
                    <p>Access settings through the gear icon in the top navigation bar.</p>
                `
            },
            'api-reference': {
                title: 'API Reference',
                content: `
                    <h5>API Documentation</h5>
                    <p>Integrate with external applications using our REST API.</p>
                    <ul>
                        <li>Authentication and API keys</li>
                        <li>Query execution endpoints</li>
                        <li>Dashboard sharing APIs</li>
                        <li>Webhook configurations</li>
                    </ul>
                    <p>Generate API keys from your user profile settings. All API requests require authentication.</p>
                `
            }
        };

        function toggleHelpWidget() {
            const card = document.getElementById('helpCard');
            const button = document.getElementById('helpButton');
            const isOpen = card.classList.contains('visible');
            
            if (isOpen) {
                card.classList.remove('visible');
                button.setAttribute('aria-expanded', 'false');
                button.setAttribute('aria-label', 'Open help dialog');
                button.focus();
            } else {
                card.classList.add('visible');
                button.setAttribute('aria-expanded', 'true');
                button.setAttribute('aria-label', 'Close help dialog');
                
                // Focus first focusable element in dialog
                setTimeout(() => {
                    const firstFocusable = card.querySelector('button');
                    if (firstFocusable) firstFocusable.focus();
                }, 100);
            }
        }

        function closeHelpWidget() {
            const card = document.getElementById('helpCard');
            const button = document.getElementById('helpButton');
            card.classList.remove('visible');
            button.setAttribute('aria-expanded', 'false');
            button.setAttribute('aria-label', 'Open help dialog');
            hideSidePanel();
            // Return focus to trigger button
            button.focus();
        }

        function showSidePanel(sectionKey) {
            const sidePanel = document.getElementById('sidePanel');
            const mainPanel = document.getElementById('mainPanel');
            const title = document.getElementById('sidePanelTitle');
            const content = document.getElementById('sidePanelContent');
            
            const section = helpContent[sectionKey];
            if (section) {
                title.textContent = section.title;
                content.innerHTML = section.content;
                
                mainPanel.classList.add('shifted');
                sidePanel.classList.add('visible');
            }
        }

        function hideSidePanel() {
            const sidePanel = document.getElementById('sidePanel');
            const mainPanel = document.getElementById('mainPanel');
            
            mainPanel.classList.remove('shifted');
            sidePanel.classList.remove('visible');
        }

        // Close widget when clicking outside
        document.addEventListener('click', function(event) {
            const widget = document.querySelector('.help-widget');
            if (!widget.contains(event.target)) {
                closeHelpWidget();
            }
        });

        // Prevent clicks inside the widget from closing it
        document.querySelector('.help-widget').addEventListener('click', function(event) {
            event.stopPropagation();
        });

        // Keyboard support: Escape key and focus trapping
        document.addEventListener('keydown', function(event) {
            const card = document.getElementById('helpCard');
            const sidePanel = document.getElementById('sidePanel');
            const isCardVisible = card.classList.contains('visible');
            const isSidePanelVisible = sidePanel.classList.contains('visible');
            
            // Handle Escape key
            if (event.key === 'Escape') {
                if (isSidePanelVisible) {
                    // Close side panel first
                    hideSidePanel();
                } else if (isCardVisible) {
                    // Close help widget
                    closeHelpWidget();
                }
                return;
            }
            
            // Focus trapping for dialog
            if (event.key === 'Tab' && isCardVisible) {
                const focusableElements = card.querySelectorAll(
                    'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
                );
                
                if (focusableElements.length === 0) return;
                
                const firstElement = focusableElements[0];
                const lastElement = focusableElements[focusableElements.length - 1];
                
                if (event.shiftKey) {
                    // Shift + Tab
                    if (document.activeElement === firstElement) {
                        lastElement.focus();
                        event.preventDefault();
                    }
                } else {
                    // Tab
                    if (document.activeElement === lastElement) {
                        firstElement.focus();
                        event.preventDefault();
                    }
                }
            }
        });
    </script>
</body>
</html>
